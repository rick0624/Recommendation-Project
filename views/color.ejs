<!DOCTYPE html>
<html>
    <head>
      <%- include ("partials/header") %>
      <title>Home</title>
    </head>
    <body>
      <!-- nav bar -->
      <%- include ("partials/nav") %>
      <!--   side bar  -->
      <!-- 更動 新增sidebar.ejs-->
      <%- include ("partials/sidebar") %>
      <div class="p-3 mx-2" style="margin-top:65px;float:left;width:75%;">
        <!--  分類  -->
        <div class="p-2"> 
          <div class="mx-3"><h5>依照類別分類 - <%= color %></h5></div>
          <hr>
          <% if (good_details.length > 0) { %>
          <!-- 範例 -->
           <% for (let i = 0; i < good_details.length; i++) { %>
            <div class="mx-3 my-3" style="width:200px;height:360px;display: inline-block">
              <a href="/product_detail/<%= good_details[i].good_id %>" style="color:black;">
                <img class="product" src="<%= good_details[i].image %>" alt="image" class="py-2" style="width:195px;height:250px;display:block;margin-left: auto;margin-right: auto;">
              </a>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color: black;"><%= good_details[i].name %></span>
              </div>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color:gray;"><%= good_details[i].description %></span>
              </div>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color:gray;">$399</span>
              </div>
              <div class="px-2">
                <% for (let j = 0; j < like_details.length; j++) { %>
                  <% if (good_details[i].good_id == like_details[j].product) { %>
                    <a href="/adding/like/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">喜歡<img src="http://localhost:8080/heart-2.png" alt="喜歡" style="width: 20px;margin: 2px;"></span></a>
                    <% break %>
                  <% } %>
                  <% if (j == like_details.length-1) { %>
                    <a href="/adding/like/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">喜歡<img src="http://localhost:8080/heart.png" alt="喜歡" style="width: 20px;margin: 2px;"></span></a>
                  <% } %>
                <% } %> 
                <% for (let j = 0; j < shoppingCart_details.length; j++) { %>
                  <% if (good_details[i].good_id == shoppingCart_details[j].product) { %>
                    <a href="/adding/shopping-cart/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">加入購物車 <img src="http://localhost:8080/add-to-cart-2.png" alt="加入購物車" style="width: 20px;margin:2px;"></span></a>
                    <% break %>
                  <% } %>
                  <% if (j == shoppingCart_details.length-1) { %>
                    <a href="/adding/shopping-cart/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">移除購物車 <img src="http://localhost:8080/add-to-cart.png" alt="加入購物車" style="width: 20px;margin:2px;"></span></a>
                  <% } %>
                <% } %>
              </div>   
            </div>
            <% } %> 
          <% } else { %>
          <br>
          <div class="mx-3"><h5 style="color:gray;">目前無此顏色商品....</h5></div><br><br>
          <% } %>
        </div>
        <!--  個人推薦  -->
        <% if (user) { %>
          <div class="p-2"> 
            <% if (recommendation_goods.length > 0) { %>
            <div class="mx-3"><h5>為您推薦</h5></div>
            <!-- 範例 -->
             <% for (let i = 0; i < recommendation_goods.length; i++) { %>
            <div class="mx-3 my-3" style="width:200px;height:360px;display: inline-block">
              <a href="/product_detail/<%= recommendation_goods[i].good_id %>" style="color:black;">
                <img class="product" src="<%= recommendation_goods[i].image %>" alt="image" class="py-2" style="width:195px;height:250px;display:block;margin-left: auto;margin-right: auto;">
              </a>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color: black;"><a href="/product_detail/<%= recommendation_goods[i].good_id %>"><%= recommendation_goods[i].name %></a></span>
              </div>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color:gray;"><%= recommendation_goods[i].description %></span>
              </div>
              <div class="px-2" style="width:170px;overflow:hidden;text-overflow:ellipsis;white-space: nowrap;">
                <span style="color:gray;">$399</span>
              </div>
              <div class="px-2">
                <% for (let j = 0; j < like_details.length; j++) { %>
                  <% if (good_details[i].good_id == like_details[j].product) { %>
                    <a href="/adding/like/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">喜歡<img src="http://localhost:8080/heart-2.png" alt="喜歡" style="width: 20px;margin: 2px;"></span></a>
                    <% break %>
                  <% } %>
                  <% if (j == like_details.length-1) { %>
                    <a href="/adding/like/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">喜歡<img src="http://localhost:8080/heart.png" alt="喜歡" style="width: 20px;margin: 2px;"></span></a>
                  <% } %>
                <% } %> 
                <% for (let j = 0; j < shoppingCart_details.length; j++) { %>
                  <% if (good_details[i].good_id == shoppingCart_details[j].product) { %>
                    <a href="/adding/shopping-cart/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">加入購物車 <img src="http://localhost:8080/add-to-cart-2.png" alt="加入購物車" style="width: 20px;margin:2px;"></span></a>
                    <% break %>
                  <% } %>
                  <% if (j == shoppingCart_details.length-1) { %>
                    <a href="/adding/shopping-cart/<%= good_details[i].good_id %>" style="text-decoration:none"><span style="color:gray;">加入購物車 <img src="http://localhost:8080/add-to-cart.png" alt="加入購物車" style="width: 20px;margin:2px;"></span></a>
                  <% } %>
                <% } %>
              </div>  
            </div>
            <% } %> 
            <% } %>
          </div>
        <% } %>
      </div>      
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js" integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ" crossorigin="anonymous"></script>
    </body>
</html>
